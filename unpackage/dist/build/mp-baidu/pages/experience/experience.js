(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/experience/experience"],{"14fc":function(e,t,i){"use strict";var n;i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var a=function(){var e=this,t=e.$createElement,i=(e._self._c,e.__map(e.home_recom,(function(t,i){var n=e.__get_orig(t),a=e.common.getimgurl(t.coverimg);return{$orig:n,g0:a}}))),n=e.__map(e.experlist,(function(t,i){var n=e.__get_orig(t),a=e.common.getimgurl(t.coverimg),o=e.common.getimgurl(t.headimg);return{$orig:n,g1:a,g2:o}}));e._isMounted||(e.e0=function(t){t.stopPropagation(),e.isPactive=0,e.choice_areaname="位置"},e.e1=function(t){t.stopPropagation(),e.isMactive=0,e.choice_stylename="风格"},e.e2=function(t){t.stopPropagation(),e.isOactive=0,e.isNactive=0}),e.$mp.data=Object.assign({},{$root:{l0:i,l1:n}})},o=[]},1765:function(e,t,i){"use strict";(function(e){i("904b");n(i("66fd"));var t=n(i("f9ac"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("5486")["createPage"])},"5ad2":function(e,t,i){"use strict";i.r(t);var n=i("97df"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},"97df":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(i("a34a")),a=o(i("52a9"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t,i,n,a,o,c){try{var s=e[o](c),r=s.value}catch(u){return void i(u)}s.done?t(r):Promise.resolve(r).then(n,a)}function s(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var o=e.apply(t,i);function s(e){c(o,n,a,s,r,"next",e)}function r(e){c(o,n,a,s,r,"throw",e)}s(void 0)}))}}var r={data:function(){return{currentIndex:1,isTactive:1,isSactive:0,isPactive:0,isMactive:0,isOactive:0,isNactive:0,istype:!1,sh:!1,h:"",h2:"",h3:"",lon:"",lat:"",userinfo:[],home_num:0,home_recom:[],citylist:[],arealist:[],stylelist:[],choice_stylename:"风格",choice_areaname:"位置",choice_pxname:"默认排序",page:1,pagesize:4,experlist:[],up_is:!0}},onReady:function(){var t=this;e.getSystemInfo({success:function(i){t.h3=i.windowHeight-e.upx2px(25)}}),this.getNodesInfo()},onLoad:function(){this.get_num(),this.get_recom(),this.city(),this.style()},onReachBottom:function(){this.page++,this.get_datalist()},methods:{get_datalist:function(){var t=this;e.request({url:t.common.websiteUrl+"experhome_home_index",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",data:{city:t.userinfo.city,lon:t.lon,lat:t.lat,choice_area:t.isPactive,choice_style:t.isMactive,choice_worktime:t.isOactive,choice_measure:t.isNactive,defsort:t.isSactive,page:t.page,pagesize:t.pagesize},success:function(e){200==e.data.code?t.experlist=t.experlist.concat(e.data.data):t.common.callback("暂无更多"),console.log(e.data.data)},fail:function(){t.common.network()}})},nothing:function(){this.istype=!1},requestAndroidPermission:function(e){return s(n.default.mark((function t(){var i;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.default.requestAndroidPermission(e);case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}}),t)})))()},get_userinfo:function(){var t=this;return new Promise((function(i,n){e.getStorage({key:"userinfo",success:function(e){t.userinfo=e.data,i("suc")},fail:function(){i("err")}})}))},car:function(){e.navigateTo({url:"../car/car"})},sure:function(){this.istype=!1,this.page=1,this.experlist=[],this.get_datalist()},get_local:function(){var t=this;return s(n.default.mark((function i(){var a;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.get_userinfo();case 2:if(i.sent,!(t.userinfo&&t.userinfo.city>0)){i.next=6;break}i.next=10;break;case 6:if(a=t.requestAndroidPermission("android.permission.ACCESS_FINE_LOCATION"),-1!=a){i.next=9;break}return i.abrupt("return",t.common.callback("您已禁止获取位置信息,部分功能可能无法展示哦"));case 9:1==a?e.getLocation({type:"wgs84",geocode:!0,success:function(e){this.lon=e.longitude,this.lat=e.latitude,console.log("已设置经纬度"+this.lon+","+this.lat)},fail:function(){this.common.callback("获取地址失败，将导致部分功能不可用")}}):0==a&&t.requestAndroidPermission("android.permission.ACCESS_FINE_LOCATION");case 10:case"end":return i.stop()}}),i)})))()},get_num:function(){var t=this;return s(n.default.mark((function i(){var a,o;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.get_local();case 2:a=t.userinfo?{city:t.userinfo.city}:{lon:t.lon,lat:t.lat},e.request({url:t.common.websiteUrl+"experhome_home_num",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",data:a,success:function(e){t.home_num=e.data.data}}),o=t,o.get_recom(),o.get_datalist();case 7:case"end":return i.stop()}}),i)})))()},get_recom:function(){var t=this;if(this.userinfo)var i={city:this.userinfo.city};else i={lon:this.lon,lat:this.lat};e.request({url:this.common.websiteUrl+"experhome_home_recom",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",data:i,success:function(e){200==e.data.code?t.home_recom=e.data.data:t.common.callback("暂无更多推荐")}}),e.request({url:this.common.websiteUrl+"service_area",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",data:i,success:function(e){200==e.data.code&&(t.arealist=e.data.data)}})},go_exper:function(t){e.navigateTo({url:"../experiencedetail/experiencedetail?id="+t,animationType:"pop-in",animationDuration:200})},city:function(){var t=this;e.request({url:this.common.websiteUrl+"service_city",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",success:function(e){200==e.data.code&&(t.citylist=e.data.data)}})},style:function(){var t=this;e.request({url:this.common.websiteUrl+"service_style",header:{"user-token":"6a109faf305513d443337ddb1ad4cb9b"},method:"post",success:function(e){200==e.data.code&&(t.stylelist=e.data.data)}})},go_map:function(e){this.common.callback("调用地图显示")},coll:function(e){this.common.callback("收藏")},go_makeapp:function(e){this.common.callback("预约")},swierChange:function(e){this.currentIndex=e.detail.current},typeselect:function(e){this.isTactive=e},sortselect:function(e){this.isSactive=e,this.istype=!1,this.page=1,this.experlist=[],this.choice_pxname=1==e?"默认排序":2==e?"距离最近":"人气最高",this.get_datalist()},placeselect:function(e,t){this.isPactive=e,this.choice_areaname=this.arealist[t].name},mannerselect:function(e,t){this.isMactive=e,this.choice_stylename=this.stylelist[t].name},orderselect:function(e){this.isOactive=e},numselect:function(e){this.isNactive=e},selecttype:function(e){this.istype=!0,this.isTactive=e},getNodesInfo:function(){var t=this,i=e.createSelectorQuery().select(".all");i.boundingClientRect().exec((function(e){t.h=e[0].height}));var n=e.createSelectorQuery().select(".type-select");n.boundingClientRect().exec((function(e){t.h2=e[0].height-10}))}},onPageScroll:function(e){e.scrollTop>=this.h?this.sh=!0:e.scrollTop<this.h&&(this.sh=!1)}};t.default=r}).call(this,i("5486")["default"])},a7a9:function(e,t,i){},e785:function(e,t,i){"use strict";var n=i("a7a9"),a=i.n(n);a.a},f9ac:function(e,t,i){"use strict";i.r(t);var n=i("14fc"),a=i("5ad2");for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);i("e785");var c,s=i("f0c5"),r=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);t["default"]=r.exports}},[["1765","common/runtime","common/vendor"]]]);